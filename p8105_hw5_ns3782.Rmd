---
title: "p8105_hw5_ns3782"
author: "NSK"
date: "2024-11-03"
output: github_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

# Load libraries

library(tidyverse)
library(ggplot2)

```

## Problem 1

```{r}

# Define function to check for shared birthdays

check_birthday = function(n) {
  birthdays = sample(1:365, size = n, replace = TRUE)
  return(length(unique(birthdays)) < n)
}

# Run simulations

birthday_results = 
  expand_grid(
    n = 2:50,
    iter = 1:10000
  ) %>%
  mutate(result = map_lgl(n, check_birthday))  %>%
  group_by(n)  %>%
  summarise(prob = mean(result))

# Plot results

ggplot(birthday_results, aes(x = n, y = prob)) + 
  geom_line() +
  labs(x = "Group Size", y = "Probability") 

```



## Problem 2

```{r}

# Create function to generate data and conduct t-test

sim_t_test = function(n = 30, mu = 0, sigma = 5) {
  
  sim_data = tibble(
    x = rnorm(n, mean = mu, sd = sigma)
  )
  
# Perform t-test against null hypothesis mu = 0
  
  t_test_results = 
    t.test(sim_data$x, mu = 0) %>%  
    broom::tidy()                 
  
# Return results
  
  return(tibble(
    mu_hat = mean(sim_data$x),
    p_value = t_test_results$p.value
  ))
}

```



## Problem 3

```{r}


```

